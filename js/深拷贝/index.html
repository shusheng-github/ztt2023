<!--
 * @Date: 2023-08-08 16:56:02
 * @LastEditors: zhangtiantian08 zhangtiantian08@58.com
 * @LastEditTime: 2024-02-20 19:23:00
 * @FilePath: /2023/js/深拷贝/index.html
-->
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Document</title>
    </head>
    <body></body>
    <!-- <script src="./index2.js"></script> -->
    <script>
        function isObject(target) {
            return typeof target === "object" && target !== null;
        }
        function deepClone(target, map = new WeakMap()) {
            if (!isObject(target)) return target;
            let result;
            if (map.has(target)) return map.get(target);
            map.set(target, result);

            for (let key in target) {
                if (target.hasOwnProperty(key)) {
                    if (isObject(key)) {
                        result[key] = deepClone(target[key], map);
                    } else {
                        result[key] = target[key];
                    }
                }
            }
            return result;
        }
        var obj = {
            a: new Map([["name", "张三"]]),
            b: new Set([1, 2, 3]),
            c: undefined,
            regex: /123/,
            d: {
                e: 1,
                f: { g: 3 }
            },
            // d: new Error("Invalid"),
            e: () => {
                console.log(11);
            }
        };
        const aa = deepClone(obj);
        const bb = JSON.parse(JSON.stringify(obj));

        console.log("clone :>> ", aa);
        console.log("JSON :>> ", bb);
        obj.d.e = 2;
    </script>
</html>
